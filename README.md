# Tennis Match Winner Predictor AI

## Overview

This project is an AI-based tennis match winner predictor using a **Random Forest** model. According to my testing it currently achieves an average of **88.2% accuracy** (V4) using the following hyperparameters:

- **n_estimators:** 186
- **max_depth:** 18
- **random_state:** None
- **min_samples_split:** 5
- **min_samples_leaf:** 1
- **max_features:** log2

>[!NOTE]
>According to my testing any further increase in depth above 20 and 500 estimators leads to a loss of accuracy. The trained AI model is stored and can be utilized to predict tennis match outcomes based on historical data from the ATP tennis tours.

## Details

This is the fourth version of the model, `final_tennis_model.pkl`. Version 2, 3 and 4 of the model can be found in the `results` folder.

V2: `s_tennis_model`

V3: `small_tennis_model`

V4: `final_tennis_model`

The difference between V2 and V3 lies mainly in their size, with V3 being half the size with minimal accuracy loss **(~0.4%)**. 

V4 however, is a sophisticated remake of V3, with the same hyperparameters but far more features, including engineered ones and has a staggering **88.2%** accuracy, and is also two thirds the size of V3, coming in at **214MB**.

## Project Structure 

The project structure is organized in a main folder named  `tennis_prediction`, which contains all scripts and subfolders required for the program to run.

ðŸ“‚ tennis_prediction

 â”œâ”€â”€ ðŸ“‚ analysis

 â”‚   â”œâ”€â”€ decision_tree **(File created by tree.py)**

 â”‚   â”œâ”€â”€ featureImp.py **(Graphing of most determinisitic features)**

 â”‚   â”œâ”€â”€ matrix.py **(Creates a confusion matrix to visually show accuracy**)

 â”‚   â”œâ”€â”€ tree.py **(Creates and visualizes all branches and notes of the random forest classifier)**

 â”œâ”€â”€ ðŸ“‚ data

 â”‚   â”œâ”€â”€ ðŸ“‚ atp

 â”‚   â”‚   â”œâ”€â”€ atp_matches_year.csv **(match data for individual years)**

 â”‚   â”‚   â”œâ”€â”€ ðŸ“‚ group **(contains year range data generated by the model)**

 â”‚   â”œâ”€â”€ ðŸ“‚ preprocessed **(preprocessed datasets)**

 â”‚   â”œâ”€â”€ player_id_mapping.csv **(Player ID to Name mapping)**

 â”œâ”€â”€ ðŸ“‚ results

 â”‚   â”œâ”€â”€ small_tennis_model.pkl **(Small Trained model - *~310MB*)**

 â”‚   â”œâ”€â”€ s_tennis_model.pkl **(Initial Trained model - *~662MB*)**

 â”‚   â”œâ”€â”€ final_tennis_model.pkl **(Current Trained model - *~214MB*)**

 â”œâ”€â”€ main.py **(Main execution script)**

 â”œâ”€â”€ combine.py **(Combines ATP match data into grouped datasets)**

 â”œâ”€â”€ mapping.py **(Creates player ID mapping file - Do not modify)**

 â”œâ”€â”€ model.py **(Defines and trains the AI model, tweaking parameters possible)**

 â”œâ”€â”€ predict.py **(Runs predictions using the trained model - Only callable from main.py)**

 â”œâ”€â”€ preprocess.py **(Processes raw data into AI-compatible format)**

 â”œâ”€â”€ settings.txt **(Configuration file - Required for all scripts)**

## Installation and Setup
### Perquisites

Ensure that you have **Python 3.x** installed, along with the following dependencies:
`pip install -r requirements.txt`
>[!IMPORTANT]
>This will install pandas, numpy, joblib, scikit-learn, seaborn, matplotlib, graphviz and scikit-optimize, all except for *scikit-optimize* are requirements for the program to run.

### Running the Application

Before running any script, navigate into the main project directory; "tennis_prediction"

`cd tennis_prediction`

Then to run the program:

`python main.py`

## Script details
### `settings.txt`
All of the python scripts rely on the existence of `settings.txt`. If this file is removed, the standalone script will not be able to run. Running `main.py` will regenerate the file with the required data which it needs.

### `main.py`
This script runs the entire tennis match prediction program and requires user input, Upon execution:
1. The user must input a **starting year** and an **ending year**.
  - The dataset contains data from 1985 to 2024.
  - Invalid values outside of this range will not be accepted.
  - Users can enter **"all"** as the starting year **ONLY** to automatically select the full range *(1985-2024)*. In this case, the ending year input is ignored.
2. The user is given the option to **retrain the model** on the chosen dataset.
  - Training takes approximately **2.5 minutes** with default setting, but will take longer if hyperparameters are increased.
>[!WARNING]
>Retraining is only recommended when using the entire dataset. Using smaller datasets may lead to a decreases in accuracy of the model or unrecognized names.
3. The user must enter the names of **two tennis players**.
  - Names must be written in **full**, using the format **"First Last"** (e.g., "Jannik Sinner" and "Carlos Alcaraz").
  - Note that the input is case-sensitive and **requires capitalization in the first and last name**
4. The program will output a **predicted winner**.
  - When retrained, predictions may vary even for the same matchups due to the AI model not running on a set random state.

### `combine.py`
Responsible for adding ATP tournament game datasets into a collection by year stored in `data/group` as `atp_matches_year_year.csv`. If the two years are the same, this file will not be created.

### `mapping.py`
Adds every player ID and name into the `player_id_mapping.csv` file, the file currently contains **4178** players.
>[!CAUTION]
>**Do not run or modify this script**, as it may reduce accuracy or result in unrecognized names

### `model.py`
Defines and trains the AI model. Users can tweak hyperparameters for different use cases. The trained model is saved as `small_tennis_model.pkl` and will print an accuracy estimation up to four decimal places upon completion.

>[!INFO]
>It is not reccomended to tweak hyperparameters without changing the name of the model as it will overwrite the current version

### `preprocess.py`
Processes raw match data for use by the AI model. It reduces the dataset by keeping only essential columns and merges the original table (split by winners and losers) into a single format, making each one match with their respective data standalone.

### `predict.py`
Handles match outcome prediction based on preprocessed data. **This script does not run via** `python predict.py` **but is instead called through** `main.py`. It strictly relies on data from `preprocessed/`, any modifications to the `DataFrame` dataset will break the prediction function. The script print the predicted winner for a tennis match between two selected players. 
>[!NOTE]
>**Player names must be written in full and are case sensitive.**

## Data Details
- The `data/atp` folder contains CSV files for each year's ATP matches.
- The **group** subfolder stores aggregated data for year ranges requested by the model.
- The total dataset size is around **25MB**, but may grow are more matched are processed.
- The `player_id_mapping.csv` provides a reference for player names based on their IDs.
- The **data in the `group` and `preprocessed` folders is a modified version of Jeff Sackmann's original ATP tour data**

## Model Details
- The trained **Random Forest model** is stored in the `results/` folder and is approximately ***214MB*** in size.
- The model is trained on historical ATP match data and uses selected hyperparameters to optimize accuracy.

## Credits
This project uses ATP tournament match data provided by **Jeff Sackmann.** You can find the original dataset at [Jeff Sackmann's GitHub Repository](https://github.com/JeffSackmann/tennis_atp). The collections of ATP data in the `group` and `preprocessed` folders are modified versions of Sackmann's original ATP tour data.
The license to the original set of data by Jeff Sackmann is found here at [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/)

## License  
Tennis Match Winner Predictor AI Â© 2025 by Matteo Walle, Jeff Sackmann is licensed under Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International. To view a copy of this license, visit https://creativecommons.org/licenses/by-nc-sa/4.0/